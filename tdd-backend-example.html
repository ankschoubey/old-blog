<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>TDD example on a backend - Upsert Method | Ankush Choubey</title>
<meta name="generator" content="Jekyll v4.1.1">
<meta property="og:title" content="TDD example on a backend - Upsert Method">
<meta property="og:locale" content="en_US">
<meta name="description" content="Learn the foundation of TDD with a simple example explained in depth.">
<meta property="og:description" content="Learn the foundation of TDD with a simple example explained in depth.">
<link rel="canonical" href="https://www.ankushchoubey.com/tdd-backend-example">
<meta property="og:url" content="https://www.ankushchoubey.com/tdd-backend-example">
<meta property="og:site_name" content="Ankush Choubey">
<meta property="og:image" content="https://www.ankushchoubey.com/images/tdd-backend-example.svg">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-08-13T00:00:00-05:00">
<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:image" content="https://www.ankushchoubey.com/images/tdd-backend-example.svg">
<meta property="twitter:title" content="TDD example on a backend - Upsert Method">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-08-13T15:52:08-05:00","datePublished":"2023-08-13T00:00:00-05:00","description":"Learn the foundation of TDD with a simple example explained in depth.","headline":"TDD example on a backend - Upsert Method","image":"https://www.ankushchoubey.com/images/tdd-backend-example.svg","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ankushchoubey.com/tdd-backend-example"},"url":"https://www.ankushchoubey.com/tdd-backend-example"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
<link type="application/atom+xml" rel="alternate" href="https://www.ankushchoubey.com/feed.xml" title="Ankush Choubey">
<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-35993343-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>



<script id="mcjs">!function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/787ccdfb3a0c625c1830ac78a/859c6d3b694fad02c3eff1603.js");</script><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>TDD example on a backend - Upsert Method | Ankush Choubey</title>
<meta name="generator" content="Jekyll v4.1.1">
<meta property="og:title" content="TDD example on a backend - Upsert Method">
<meta property="og:locale" content="en_US">
<meta name="description" content="Learn the foundation of TDD with a simple example explained in depth.">
<meta property="og:description" content="Learn the foundation of TDD with a simple example explained in depth.">
<link rel="canonical" href="https://www.ankushchoubey.com/tdd-backend-example">
<meta property="og:url" content="https://www.ankushchoubey.com/tdd-backend-example">
<meta property="og:site_name" content="Ankush Choubey">
<meta property="og:image" content="https://www.ankushchoubey.com/images/tdd-backend-example.svg">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-08-13T00:00:00-05:00">
<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:image" content="https://www.ankushchoubey.com/images/tdd-backend-example.svg">
<meta property="twitter:title" content="TDD example on a backend - Upsert Method">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-08-13T15:52:08-05:00","datePublished":"2023-08-13T00:00:00-05:00","description":"Learn the foundation of TDD with a simple example explained in depth.","headline":"TDD example on a backend - Upsert Method","image":"https://www.ankushchoubey.com/images/tdd-backend-example.svg","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ankushchoubey.com/tdd-backend-example"},"url":"https://www.ankushchoubey.com/tdd-backend-example"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet">
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css">
<link type="application/atom+xml" rel="alternate" href="https://www.ankushchoubey.com/feed.xml" title="Ankush Choubey">
<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-35993343-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body>
<header class="site-header">

  <div class="wrapper">
<a class="site-title" rel="author" href="/">Ankush Choubey</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
<a class="page-link" href="/core-values-page/">Core Values</a><a class="page-link" href="/philosophy/">Life &amp; Self Improvement</a><a class="page-link" href="/resume">Hire me!</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/tdd/">Test First Test Everything</a>
</div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <style>
  .page-content{
    padding-top: 0px;
  }
  .post-header{
    display: flex;
    flex-direction: column;
    justify-content: end;
          height: 300px;}

  .cover-image{
    position: absolute;
    left:0px;
    height: 300px;
    object-fit: cover;
    width: 100%;
  }

  @media screen and (max-width: 500px) {
    .post-header{height: 550px;}
    .cover-image{
      height: 550px;
    }
  }
  .post-header-content{backdrop-filter: blur(200px); 
    padding: 0px 20px;
    -webkit-backdrop-filter: blur(200px);
        background: #ffffffcf;}
</style>

<header class="post-header"><img src="/images/tdd-backend-example.svg" class="cover-image"><div class="post-header-content">
    <h1 class="post-title p-name" itemprop="name headline">TDD example on a backend - Upsert Method</h1>
<p class="page-description">Learn the foundation of TDD with a simple example explained in depth.</p>
<p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-08-13T00:00:00-05:00" itemprop="datePublished">
        Aug 13, 2023
      </time>
      • <span class="read-time" title="Estimated read time">
    
    
      12 min read
    
</span></p>

    
    <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i>
      
      <a class="category-tags-link" href="/categories/#testing">testing</a>
       
      
      <a class="category-tags-link" href="/categories/#tdd">tdd</a>
      
      
    </p>
    

    </div>
</header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
     
    <div class="flash announce-block">
    <svg class="octicon octicon-megaphone" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><g fill-rule="evenodd"><path d="M3.25 9a.75.75 0 01.75.75c0 2.142.456 3.828.733 4.653a.121.121 0 00.05.064.207.207 0 00.117.033h1.31c.085 0 .18-.042.258-.152a.448.448 0 00.075-.366A16.74 16.74 0 016 9.75a.75.75 0 011.5 0c0 1.588.25 2.926.494 3.85.293 1.113-.504 2.4-1.783 2.4H4.9c-.686 0-1.35-.41-1.589-1.12A16.42 16.42 0 012.5 9.75.75.75 0 013.25 9z"></path><path d="M0 6a4 4 0 014-4h2.75a.75.75 0 01.75.75v6.5a.75.75 0 01-.75.75H4a4 4 0 01-4-4zm4-2.5a2.5 2.5 0 000 5h2v-5H4z"></path><path d="M15.59.082A.75.75 0 0116 .75v10.5a.75.75 0 01-1.189.608l-.002-.001h.001l-.014-.01a5.829 5.829 0 00-.422-.25 10.58 10.58 0 00-1.469-.64C11.576 10.484 9.536 10 6.75 10a.75.75 0 110-1.5c2.964 0 5.174.516 6.658 1.043.423.151.787.302 1.092.443V2.014c-.305.14-.669.292-1.092.443C11.924 2.984 9.713 3.5 6.75 3.5a.75.75 0 110-1.5c2.786 0 4.826-.484 6.155-.957.665-.236 1.154-.47 1.47-.64a5.82 5.82 0 00.421-.25l.014-.01a.75.75 0 01.78-.061zm-.78.06zm.44 11.108l-.44.607.44-.607z"></path></g></svg>
    <strong>Announcement: </strong> <a href="https://www.ankushchoubey.com/tdd">This blog post part of my free 'Test First Test Everything' series. Explore the complete series for comprehensive insights and guidance.     
        <img style="
        background: #f0f8ff00;
        max-width: 300px;" src="/images/tdd.png">
    </a>
</div>


  
  <div class="post-content e-content" itemprop="articleBody">
    <p>The upsert method is one of my favorite examples to teach when explaining TDD. It’s simple easy and gets the point across.</p>

<p>This article is about backend TDD testing. The same applied to the front end but we’ll see it in a different post. The example presented is using Spring Boot, but you can do this in any language.</p>

<p>I’ll present the problem statement. Then explain the implementation while doing TDD. Later, we’ll introduce a special scenario that would help us iterate on what we wrote initially.</p>

<p>The post can seem a bit exaggerated. In many places “good Java” practices will not be followed. A senior developer may feel a lot of explanation is unnecessary. The intent is learning and therefore, the focus of this post is to give an example that you could find relatable when you face a real problem. The blog post is therefore too detailed.</p>

<h2 id="problem-statement-for-upsert">Problem statement for <strong>upsert</strong>
</h2>

<p>Here’s the problem statement.</p>

<p>You have a “movies” table in the database. The table stores all values related to a movie.  You want only one entry for each movie. If the data for a movie is present, you just update the data. If the data is not present, you insert the data. In both cases, it’ll return the data from the database.</p>

<p>In MongoDB, terms this is called an “upsert” operation. So we’ll try to write an upsert method ourselves with TDD.</p>

<h2 id="getting-started">Getting Started</h2>

<p><img src="/images/tdd.png" alt="TDD Flow"></p>

<p>//TODO explain the process we will follow</p>

<h3 id="step-1-skeletal">Step 1: Skeletal</h3>

<p>To start with TDD, we first start creating the test file. But I often find it easier to decide the structure of the code first and then start writing the tests. This way I’d avoid compilation errors. At this stage, I won’t write any business logic.</p>

<p>You think of 3 classes,</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">Movie</code> class. Represents a movie in the database.</li>
  <li>
<code class="language-plaintext highlighter-rouge">MovieRepository</code> is a class used to query the database.</li>
  <li>
<code class="language-plaintext highlighter-rouge">MovieService</code> which includes our business logic for the <code class="language-plaintext highlighter-rouge">upsert</code> method.</li>
</ul>

<p>You go ahead and create the classes.</p>

<p><strong>Movie.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Movie</span> <span class="o">{</span>
 <span class="nd">@Id</span> <span class="kd">private</span> <span class="nc">String</span> <span class="n">movieId</span><span class="o">;</span>
 <span class="kd">private</span> <span class="nc">String</span> <span class="n">movieName</span><span class="o">;</span>
 <span class="nd">@Version</span> <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">version</span><span class="o">;</span> <span class="c1">// We'll see the use of this @Version in the last section where we need to update our code.</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>MovieRepository.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MovieRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Movie</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;{</span>
 <span class="c1">//This class is currently empty </span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>MovieService</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">class</span> <span class="nc">MovieService</span> <span class="o">{</span>
 <span class="kd">public</span> <span class="nc">Movie</span> <span class="nf">upsert</span><span class="o">(</span><span class="nc">Movie</span> <span class="n">movie</span><span class="o">){</span>
  <span class="c1">// Note how we are skipping logic and only developing skeleton code.</span>
  <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
 <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="step-2-write-the-failing-test">Step 2: Write the failing test</h3>

<p>We switch to tests. In IntelliJ, we have a handy shortcut, <code class="language-plaintext highlighter-rouge">Ctrl + Shift + T</code> to switch to the test or create a test file.</p>

<p>We created 3 classes. But we’ll write the test for only one, here’s why:</p>

<ol>
  <li>
<strong>Movie</strong> class is just a data class. It does not include any logic.</li>
  <li>
<strong>MovieRepository</strong> is an interface that <code class="language-plaintext highlighter-rouge">Spring Data JPA</code> would implement. Spring Data JPA is an ORM. For those who don’t know ORM or how <code class="language-plaintext highlighter-rouge">Sprint Data JPA</code> works, consider the <code class="language-plaintext highlighter-rouge">extends JpaRepository</code> to handle all the database-related operations like getting data from the database and saving. As this is implemented by the Spring Data JPA library, we’ll not write the test for it.&lt;Note: It’s often good to confirm an external library’s behavior via tests)</li>
  <li>
<strong>MovieService</strong>: This is the only class that has our business logic.</li>
</ol>

<p>To write a skeleton test class for MovieService.</p>

<p><strong>MovieServiceTest.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@DataMongoTest</span>
<span class="nd">@Import</span><span class="o">(</span><span class="nc">MovieService</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MovieServiceTest</span><span class="o">{</span>
 <span class="c1">// empty </span>
<span class="o">}</span>
</code></pre></div></div>

<p>In TDD, we iterate on scenarios. For each scenario,</p>

<ol>
  <li>we start by writing a test.</li>
  <li>This test fails because our code doesn’t exist yet.</li>
  <li>Then write the code that will pass our test.</li>
  <li>This covers our one scenario.</li>
</ol>

<p>We repeat steps 1 to 4 for each scenario. For upsert, we kind of have two scenarios.</p>
<ol>
  <li>If the data is not present, you insert the data.</li>
  <li>If the data for a movie is present, you just update the data.</li>
</ol>

<p>When you are doing TDD yourself, it’s helpful to identify scenarios that would help you get started. I have explained the scenarios in detail here <insert link="">.</insert></p>

<p>Let’s start with the first scenario. <code class="language-plaintext highlighter-rouge">If the data is not present, you insert the data.</code></p>

<p>In the test file, I write</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nd">@Autowired</span> <span class="nc">MovieService</span> <span class="n">movieService</span><span class="o">;</span>
 <span class="nd">@Autowired</span> <span class="nc">MovieRepository</span> <span class="n">movieRepository</span><span class="o">;</span>
 
 <span class="nd">@Nested</span>
 <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"upsert method"</span><span class="o">)</span>
 <span class="kd">class</span> <span class="nc">UpsertMethod</span><span class="o">{</span>
  <span class="nd">@Nested</span>
  <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"WHEN movie is not present"</span><span class="o">)</span>
  <span class="kd">class</span> <span class="nc">WhenMovieIsNotPresent</span><span class="o">{</span>
   <span class="nd">@Test</span>
   <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"SHOULD insert movie in the database"</span><span class="o">)</span>
   <span class="kt">void</span> <span class="nf">shouldInsertMovieInTheDatabase</span><span class="o">(){</span>
    <span class="c1">// given: a movie</span>
     <span class="nc">Movie</span> <span class="n">unsavedMovie</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Movie</span><span class="o">(</span><span class="s">"M1"</span><span class="o">,</span> <span class="s">"Avengers"</span><span class="o">);</span>
    <span class="c1">//When: upsert the movie</span>
     <span class="nc">Movie</span> <span class="n">responseMovie</span> <span class="o">=</span> <span class="n">movieService</span><span class="o">.</span><span class="na">upsert</span><span class="o">(</span><span class="n">unsavedMovie</span><span class="o">);</span>
    <span class="c1">// then: movies should get saved in the database.</span>
     <span class="nc">Movie</span> <span class="n">movieFromDatabase</span> <span class="o">=</span> <span class="n">movieRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">unsavedMovie</span><span class="o">.</span><span class="na">getMovieId</span><span class="o">());</span>
     <span class="n">assertThat</span><span class="o">(</span><span class="n">movieFromDatabase</span><span class="o">)</span>
      <span class="o">.</span><span class="na">isNotNull</span><span class="o">()</span>
      <span class="o">.</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">unsavedMovie</span><span class="o">);</span>
   <span class="o">}</span>
  <span class="o">}</span>
 <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The above test is purposefully written using the GIVEN/WHEN/THEN format.</p>

<p>Here:</p>

<ol>
  <li>We create a movie object.</li>
  <li>We call our upsert method.</li>
  <li>Then we check the database to see if the movie was inserted.</li>
</ol>

<p>This is our first test. Note that we haven’t written the code yet.</p>

<h2 id="step-3-run-the-test">Step 3: Run the test</h2>

<p>We should run the test because we expect it to fail. Sometimes, when we run the test before writing the code, our tests pass.</p>

<p>If our test passes before writing the code, it means either we have written a bad test or that scenario was already handled.</p>

<p>If our test fails, it means we are doing TDD right. The tests are expected to fail. So they should fail.</p>

<h2 id="step-3-write-the-code">Step 3: Write the code</h2>

<p>Now let’s write the code only against the test we have written. And note more.</p>

<p>{It’s a TDD Red Flag to write more code than what will pass the test. So only write that much code that passes the test. This way, you’ll have precise code and precise tests.}</p>

<p><strong>MovieService.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">class</span> <span class="nc">MovieService</span> <span class="o">{</span>
 <span class="nd">@Autowired</span>
 <span class="nc">MovieRepository</span> <span class="n">repo</span><span class="o">;</span>

 <span class="kd">public</span> <span class="nc">Movie</span> <span class="nf">upsert</span><span class="o">(</span><span class="nc">Movie</span> <span class="n">movie</span><span class="o">){</span>
  <span class="k">return</span> <span class="n">repo</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">movie</span><span class="o">);</span>
 <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Now that our code is written. As you can see, it didn’t take a lot to pass our failing test. We just needed one line. But writing the test ensures that it always passes.</p>

<p>Sometimes, it may seem trivial to write a test for a one-liner. But stick with TDD. The goal here isn’t the present. It’s future maintainability as multiple developers work on the same codebase and modify behavior. Our tests ensure that our expected behavior is preserved. Later in this blog post, I’ll introduce a scenario where we have to modify the test, and you’ll see how the test helps.</p>

<div id="mc_embed_shell" style="border: 10px solid; margin: 100px 0px; padding: 20px;">
    <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
<style type="text/css">
      #mc_embed_signup{background:#fff; false;clear:left; font:14px Helvetica,Arial,sans-serif; width: 600px;}
      /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
         We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
    <img src="/images/signup.jpg" style="width: 50%;object-fit: contain;"> 
    <a style="display: none;" href="https://www.freepik.com/free-vector/email-campaign-concept-illustration_7367537.htm#query=sign%20up%20email&amp;position=1&amp;from_view=search&amp;track=ais">Image by storyset on Freepik</a>
  <form action="https://ankushchoubey.us21.list-manage.com/subscribe/post?u=787ccdfb3a0c625c1830ac78a&id=51f57ce68a&f_id=002959e1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
      <div id="mc_embed_signup_scroll">
        <h2>If you liked this blogpost on "TDD example on a backend - Upsert Method" you'll also like my other blogposts.</h2>
        <h3>Keep the exploration alive – subscribe to my mailing list and receive more articles like this one</h3>
          <div class="indicates-required">
<span class="asterisk">*</span> indicates required</div>
          <div class="mc-field-group">
            <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
            <input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text">Your email ids will not be shared with anyone.</span>
</div>
<div class="mc-field-group input-group">
<strong>Type of content you are interested in? <span class="asterisk">*</span></strong>
                <ul>
<li>
<input type="radio" name="MMERGE6" id="mce-MMERGE60" value="Programming"><label for="mce-MMERGE60">Programming</label>
</li>
<li>
<input type="radio" name="MMERGE6" id="mce-MMERGE61" value="Philosophy"><label for="mce-MMERGE61">Philosophy</label>
</li>
<li>
<input type="radio" name="MMERGE6" id="mce-MMERGE62" value="Both"><label for="mce-MMERGE62">Both</label>
</li>
</ul>
<span id="mce-MMERGE6-HELPERTEXT" class="helper_text">I'll send only those blogposts that are interesting to you.</span>
</div>
      <div id="mce-responses" class="clear foot">
          <div class="response" id="mce-error-response" style="display: none;"></div>
          <div class="response" id="mce-success-response" style="display: none;"></div>
      </div>
  <div aria-hidden="true" style="position: absolute; left: -5000px;">
      /* real people should not fill this in and expect good things - do not remove this or risk form bot signups */
      <input type="text" name="b_787ccdfb3a0c625c1830ac78a_51f57ce68a" tabindex="-1" value="">
  </div>
      <div class="optionalParent">
          <div class="clear foot">
              <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="button" value="Subscribe">
              <p style="margin: 0px auto; display: none;"><a href="http://eepurl.com/iwHRjY" title="Mailchimp - email marketing made easy and fun"><span style="display: inline-block; background-color: transparent; border-radius: 4px;"><img class="refferal_badge" src="https://digitalasset.intuit.com/render/content/dam/intuit/mc-fe/en_us/images/intuit-mc-rewards-text-dark.svg" alt="Intuit Mailchimp" style="width: 220px; height: 40px; display: flex; padding: 2px 0px; justify-content: center; align-items: center;"></span></a></p>
          </div>
      </div>
  </div>
</form>
</div>
<p style="display: flex;margin: 0px !important;gap: 10px;">
    Hire me for consulting, speaking and developer roles by contacting me on <a href="https://www.linkedin.com/in/ankushchoubey/"><img src="/images/LI-Logo.png" style="height: 2ch;    background: #f0f8ff00;" alt="LinkedIn logo"></a>.
</p>
<script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[6]='MMERGE6';ftypes[6]='radio';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
</div>

<h2 id="step-4-run-the-test">Step 4: Run the test</h2>

<p>Now that the code is written, run the test and you’ll hopefully see the scenario pass.</p>

<p>If your test doesn’t pass, debug and you’ll find an issue. If it’s something that you don’t understand, mention it in the comments below and I’ll answer.</p>

<h2 id="step-5-repeat-the-write-test---run-test--write-code-cycle-for-the-second-scenario">Step 5: Repeat the write test -&gt; run test-&gt; write code cycle for the second scenario</h2>

<p>Our second scenario for <code class="language-plaintext highlighter-rouge">upsert</code> was: If the data for a movie is present, you just update the data.</p>

<p>Here is how I’d write the failing test:</p>

<p><strong>MovieServiceTest.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nd">@Nested</span>
 <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"upsert method"</span><span class="o">)</span>
 <span class="kd">class</span> <span class="nc">UpsertMethod</span><span class="o">{</span>
  <span class="o">...</span> <span class="n">previous</span> <span class="n">test</span> <span class="n">is</span> <span class="n">here</span>
  <span class="nd">@Nested</span>
  <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"WHEN movie is present"</span><span class="o">)</span>
  <span class="kd">class</span> <span class="nc">WhenMovieIsNotPresent</span><span class="o">{</span>
   <span class="nd">@Test</span>
   <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"SHOULD update the movie in the database"</span><span class="o">)</span>
   <span class="kt">void</span> <span class="nf">shouldInsertMovieInTheDatabase</span><span class="o">(){</span>
    <span class="c1">// given: a movie</span>
     <span class="nc">Movie</span> <span class="n">savedMovie</span> <span class="o">=</span> <span class="n">movieService</span><span class="o">.</span><span class="na">upsert</span><span class="o">(</span><span class="k">new</span> <span class="nc">Movie</span><span class="o">(</span><span class="s">"M1"</span><span class="o">,</span> <span class="s">"Avengers"</span><span class="o">));</span>
     <span class="nc">String</span> <span class="n">newMovieName</span> <span class="o">=</span> <span class="s">"Avengers: Infinity War"</span><span class="o">;</span>
     <span class="nc">Movie</span> <span class="n">unsavedUpdatedMovie</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Movie</span><span class="o">(</span><span class="n">savedMovie</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">newMovieName</span><span class="o">);</span>
    <span class="c1">// when: upsert the movie</span>
     <span class="nc">Movie</span> <span class="n">responseMovie</span> <span class="o">=</span> <span class="n">movieService</span><span class="o">.</span><span class="na">upsert</span><span class="o">(</span><span class="n">unsavedUpdatedMovie</span><span class="o">);</span>
    <span class="c1">// then: movies should get saved in the database.</span>
     <span class="nc">Movie</span> <span class="n">movieFromDatabase</span> <span class="o">=</span> <span class="n">movieRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">responseMovie</span><span class="o">.</span><span class="na">getMovieId</span><span class="o">());</span>
     <span class="n">assertThat</span><span class="o">(</span><span class="n">movieFromDatabase</span><span class="o">)</span>
      <span class="o">.</span><span class="na">isNotNull</span><span class="o">()</span>
      <span class="o">.</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">unsavedUpdatedMovie</span><span class="o">);</span>
   <span class="o">}</span>
  <span class="o">}</span>
 <span class="o">}</span>
</code></pre></div></div>

<p>I run the test and see if it’s failing.</p>

<p>Then I write the code for updating and passing the scenario.</p>

<p><strong>MovieService.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">class</span> <span class="nc">MovieService</span> <span class="o">{</span>
 <span class="nd">@Autowired</span>
 <span class="nc">MovieRepository</span> <span class="n">repo</span><span class="o">;</span>

 <span class="kd">public</span> <span class="nc">Movie</span> <span class="nf">upsert</span><span class="o">(</span><span class="nc">Movie</span> <span class="n">movie</span><span class="o">){</span>
  <span class="nc">Movie</span> <span class="n">movieToSave</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">movie</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
  <span class="k">if</span><span class="o">(</span><span class="n">movieToSave</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
   <span class="n">movieToSave</span><span class="o">.</span><span class="na">setMovieName</span><span class="o">(</span><span class="n">movie</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
   <span class="n">movieToSave</span> <span class="o">=</span> <span class="n">movie</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">repo</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">movieToSave</span><span class="o">);</span>
 <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>In the above code, we first check in the database to see if the <code class="language-plaintext highlighter-rouge">movie</code> exists.</p>

<ul>
  <li>If it exists, we update the <code class="language-plaintext highlighter-rouge">movieName</code>.</li>
  <li>If it does not exist, we just save the <code class="language-plaintext highlighter-rouge">movie</code>.</li>
</ul>

<p>This time we run all the tests in the test file to see if all of them pass. When you are developing a complex scenario, it may happen that while you are building one scenario, you break the functionality of another. Therefore running all the test scenarios would verify if the code is still working as expected.</p>

<p>Congratulations! You have done your first TDD cycle.</p>

<p>We wrote the failing test. We ran it. We wrote the code against the failing test and it passed. We repeated the cycle for the number of scenarios we had.</p>

<h2 id="a-new-problem">A new problem</h2>

<p>The following is a real problem I faced when the <code class="language-plaintext highlighter-rouge">upsert</code> method was run in parallel.</p>

<p>{This might be a bit advanced for beginner developers. If you are a beginner, read up on what locking means in parallel programming.}</p>

<p>Our <code class="language-plaintext highlighter-rouge">movie</code> microservice is being used by a lot of people at once. And therefore, our <code class="language-plaintext highlighter-rouge">upsert</code> method is being called many times parallelly. We have started getting MongoDB’s <strong>OptimisticLockingException</strong>. All our tests work but they don’t get the <code class="language-plaintext highlighter-rouge">OptimisticLockingException</code>.</p>

<p>The  <code class="language-plaintext highlighter-rouge">OptimisticLockingException</code> occurs when two different threads try to update the same row in a MongoDB database.</p>

<p>Pay attention to the version field below.</p>

<p>Suppose data in the database is <code class="language-plaintext highlighter-rouge">{movieId: "M1", movieName: "Avengers", version: 1}</code></p>

<ul>
  <li>This data is read by two threads:
    <ul>
      <li>The <strong>first thread</strong> tries to save the record as <code class="language-plaintext highlighter-rouge">{movieId: "M1", movieName: "Avengers: Infinity War", version: 1}</code>
</li>
      <li>The <strong>second thread</strong> tries to save the record as <code class="language-plaintext highlighter-rouge">{movieId: "M1", movieName: "Avengers: End Game", version: 1}</code>
</li>
    </ul>
  </li>
</ul>

<p>The version is incremented by MongoDB only when the data is saved. Both threads are trying to update on the same version.
If one of them is saved, then the version field is incremented and the other one cannot save since it’s trying to update a version that does not exist.</p>

<p><img class="mermaid" src="https://mermaid.ink/svg/eyJjb2RlIjoiZmxvd2NoYXJ0IFREXG5UaHJlYWQxIC0tPiB8VXBkYXRlIHZlcnNpb24gMXwgY2hlY2tcblRocmVhZDIgLS0-IHxVcGRhdGUgdmVyc2lvbiAxfCBjaGVja1xuc3ViZ3JhcGggTW9uZ29EQlxuY2hlY2t7aXMgdGhlIHZlcnNpb24gaW4gREIgc2FtZX1cbmNoZWNrIC0tPiB8dmVyc2lvbiBpcyBzYW1lfCB1cGRhdGVfZGF0YWJhc2VbVXBkYXRlIERhdGFiYXNlXS0tPiBpbmNyZW1lbnRfdmVyc2lvbltJbmNyZW1lbnQgVmVyc2lvbl1cbmNoZWNrIC0tPiB8dmVyc2lvbiBpcyBkaWZmZXJlbnQgfCBUaHJvd1tUaHJvdyBhbiBPcHRpbWlzdGljTG9ja2luZ0V4Y2VwdGlvbl1cbmVuZCIsIm1lcm1haWQiOm51bGx9"></p>

<p>There are two ways to debug, one is to run the code manually and try to replicate multiple save scenarios by firing the method manually. But this is a non-TDD way.</p>

<p>The #WayOfTDD is, to write a test that generates the same scenario. Since I have faced this scenario before, I’ll share what I had done. Below is an excerpt from my article <a href="https://www.ankushchoubey.com/optimistic-locking-exception-mongodb/">Solving an OptimisticLockingException During Upsert in MongoDB-Spring Webflux</a></p>

<p>I created a test as follows:</p>

<ol>
  <li>Manipulate documents parallel. This was done with <code class="language-plaintext highlighter-rouge">@RepeatableTest</code> and <code class="language-plaintext highlighter-rouge">@Execution(CONCURENT)</code>
</li>
  <li>Assertion wasn’t straightforward with <code class="language-plaintext highlighter-rouge">@RepeatableTest</code> so I instead collected all versions in a static list.</li>
  <li>After all <code class="language-plaintext highlighter-rouge">@RepeatableTests</code> were over I asserted if the version was as expected.</li>
  <li>I ran the code and saw <code class="language-plaintext highlighter-rouge">OptimisticLockingException</code> occurring and the assertion fails.</li>
  <li>I replaced <code class="language-plaintext highlighter-rouge">repository</code> <code class="language-plaintext highlighter-rouge">find</code> and <code class="language-plaintext highlighter-rouge">save</code> with <code class="language-plaintext highlighter-rouge">MongoOperation</code> <code class="language-plaintext highlighter-rouge">update</code> as described above.</li>
  <li>The test passed.</li>
</ol>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Nested</span>
<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"WHEN upsert is called parallely"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">WhenUpsertIsCalledParallelyTest</span><span class="o">{</span>
    
    <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Long</span> <span class="n">repeatTimes</span> <span class="o">=</span> <span class="mi">100</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">allVersions</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="nd">@RepeatableTest</span><span class="o">(</span><span class="n">repeatTimes</span><span class="o">)</span>                           <span class="c1">// Part of Step 1</span>
    <span class="nd">@Execution</span><span class="o">(</span><span class="no">CONCURRENT</span><span class="o">)</span>                                 <span class="c1">// Part of Step 1</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"SHOULD manipulate a single record"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">shouldManipulateASingleRecord</span><span class="o">(){</span>
        <span class="c1">// when:</span>
         
            <span class="nc">Movie</span> <span class="n">movie</span> <span class="o">=</span> <span class="n">movieService</span><span class="o">.</span><span class="na">upsert</span><span class="o">(</span><span class="k">new</span> <span class="nc">Movie</span><span class="o">(</span><span class="s">"M1"</span><span class="o">,</span> <span class="s">"Avengers"</span><span class="o">)).</span><span class="na">block</span><span class="o">();</span> <span class="c1">// Part of Step 1</span>
        <span class="c1">// data collection:</span>
            <span class="n">allVersions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">movie</span><span class="o">.</span><span class="na">getVersion</span><span class="o">());</span>         <span class="c1">// Part of Step 2</span>
    <span class="o">}</span>

    <span class="nd">@AfterAll</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">assertVersionIsRepeatTimes</span><span class="o">(){</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="nc">Collections</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">version</span><span class="o">))</span>                <span class="c1">// Part of Step 3</span>
            <span class="o">.</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">repeatTimes</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>After writing this code, I was able to reproduce the <code class="language-plaintext highlighter-rouge">OptimisticLockingException</code></p>

<p>Then I modified the code like this to make it pass.</p>

<p><strong>MovieService.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">class</span> <span class="nc">MovieService</span> <span class="o">{</span>
 <span class="nd">@Autowired</span>
 <span class="nc">MongoOperations</span> <span class="n">mongoOperations</span><span class="o">;</span>

 <span class="kd">public</span> <span class="nc">Movie</span> <span class="nf">upsert</span><span class="o">(</span><span class="nc">Movie</span> <span class="n">movie</span><span class="o">){</span>
  <span class="nc">Update</span> <span class="n">updateQuery</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Update</span><span class="o">()</span>
   <span class="o">.</span><span class="na">setOnInsert</span><span class="o">(</span><span class="s">"movieId"</span><span class="o">,</span> <span class="n">movie</span><span class="o">.</span><span class="na">getId</span><span class="o">())</span>
   <span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"movieName, movie.getName()); // code to update document
  return mongoOperation.findAndModify(
   query(where("</span><span class="n">movieId</span><span class="err">"</span><span class="o">).</span><span class="na">is</span><span class="o">(</span><span class="n">movie</span><span class="o">.</span><span class="na">getId</span><span class="o">())),</span> <span class="n">updateQuery</span><span class="o">,</span> <span class="n">options</span><span class="o">().</span><span class="na">returnNew</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">upsert</span><span class="o">(</span><span class="kc">true</span><span class="o">),</span> <span class="nc">Movie</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
 <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>I ran the test and the tests passed.</p>

<h2 id="ending">Ending</h2>

<p>What you have learned today is TDD in its purest. Hope you have practiced it step by step. If you have, do share your code’s GitHub/Gitlab in the comments section.</p>

<p>We went from understanding the problem to developing the solution in a TDD way.</p>

<ol>
  <li>We created a rough skeleton.</li>
  <li>We wrote a failing test for a scenario.</li>
  <li>We wrote our code against the failing test enough to pass it.</li>
  <li>Our test passed and we repeated the cycle for all the scenarios.</li>
</ol>

<p>Later, we realized a new problem in our code, and replicated it,</p>
<ol>
  <li>We came up with a hypothesis.</li>
  <li>Wrote a test to validate the hypothesis</li>
  <li>Wrote the code against the test to pass it.</li>
</ol>

<p>You have learned something that’s truly the foundation of writing good code. In upcoming blog posts, we’ll see how to test REST APIs, frontends, etc.</p>

<p>If you have any questions, suggestions, or observations or just want to connect, feel free to use the comments box below! Your knowledge-sharing will be helpful to everyone.</p>

  </div>
     
    <div class="flash announce-block">
    <svg class="octicon octicon-megaphone" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><g fill-rule="evenodd"><path d="M3.25 9a.75.75 0 01.75.75c0 2.142.456 3.828.733 4.653a.121.121 0 00.05.064.207.207 0 00.117.033h1.31c.085 0 .18-.042.258-.152a.448.448 0 00.075-.366A16.74 16.74 0 016 9.75a.75.75 0 011.5 0c0 1.588.25 2.926.494 3.85.293 1.113-.504 2.4-1.783 2.4H4.9c-.686 0-1.35-.41-1.589-1.12A16.42 16.42 0 012.5 9.75.75.75 0 013.25 9z"></path><path d="M0 6a4 4 0 014-4h2.75a.75.75 0 01.75.75v6.5a.75.75 0 01-.75.75H4a4 4 0 01-4-4zm4-2.5a2.5 2.5 0 000 5h2v-5H4z"></path><path d="M15.59.082A.75.75 0 0116 .75v10.5a.75.75 0 01-1.189.608l-.002-.001h.001l-.014-.01a5.829 5.829 0 00-.422-.25 10.58 10.58 0 00-1.469-.64C11.576 10.484 9.536 10 6.75 10a.75.75 0 110-1.5c2.964 0 5.174.516 6.658 1.043.423.151.787.302 1.092.443V2.014c-.305.14-.669.292-1.092.443C11.924 2.984 9.713 3.5 6.75 3.5a.75.75 0 110-1.5c2.786 0 4.826-.484 6.155-.957.665-.236 1.154-.47 1.47-.64a5.82 5.82 0 00.421-.25l.014-.01a.75.75 0 01.78-.061zm-.78.06zm.44 11.108l-.44.607.44-.607z"></path></g></svg>
    <strong>Announcement: </strong> <a href="https://www.ankushchoubey.com/tdd">This blog post part of my free 'Test First Test Everything' series. Explore the complete series for comprehensive insights and guidance.     
        <img style="
        background: #f0f8ff00;
        max-width: 300px;" src="/images/tdd.png">
    </a>
</div>


  <div id="mc_embed_shell">
    <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
<style type="text/css">
      #mc_embed_signup{background:#fff; false;clear:left; font:14px Helvetica,Arial,sans-serif; width: 600px;}
      /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
         We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
    <img src="/images/signup-homescreen.png" style="background: #0000ff00;max-height: 150px;">
    <a style="font-size: 1px;" href="https://www.freepik.com/free-vector/hacker-operating-laptop-cartoon-icon-illustration-technology-icon-concept-isolated-flat-cartoon-style_11602236.htm#query=programmer&amp;position=1&amp;from_view=search&amp;track=sph">Image by catalyststuff  on Freepik</a>
  <form action="https://ankushchoubey.us21.list-manage.com/subscribe/post?u=787ccdfb3a0c625c1830ac78a&id=51f57ce68a&f_id=002959e1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
    <p style="display: flex;margin: 0px !important;gap: 10px;">
        Hire me for consulting, speaking and developer roles by contacting me on <a href="https://www.linkedin.com/in/ankushchoubey/"><img src="/images/LI-Logo.png" style="height: 2ch;    background: #f0f8ff00;" alt="LinkedIn logo"></a>.
    </p>  
    <div id="mc_embed_signup_scroll">
<p>For more articles like this one, subcribe to my email newsletter for captivating articles at the crossroads of Software Engineering and Philosophy.</p>
          <div class="indicates-required" style="display: none;">
<span class="asterisk">*</span> indicates required</div>
          <div class="mc-field-group">
<label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label><input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
</div>
      <div id="mce-responses" class="clear foot">
          <div class="response" id="mce-error-response" style="display: none;"></div>
          <div class="response" id="mce-success-response" style="display: none;"></div>
      </div>
  <div aria-hidden="true" style="position: absolute; left: -5000px;">
      /* real people should not fill this in and expect good things - do not remove this or risk form bot signups */
      <input type="text" name="b_787ccdfb3a0c625c1830ac78a_51f57ce68a" tabindex="-1" value="">
  </div>
      <div class="optionalParent">
          <div class="clear foot">
              <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="button" value="Subscribe">
              <p class="brandingLogo" style="margin: 0px auto;"><a href="http://eepurl.com/iwHRjY" title="Mailchimp - email marketing made easy and fun"><img src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg" alt="referral badge"></a></p>
          </div>
      </div>
  </div>
</form>
</div>
<script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
</div>

<style>
div#mc_embed_signup{
    width: auto !important;
    display: flex;
    justify-content: center;
    align-content: center;
}
form#mc_embed_signup{
    max-width: 800px !important;
}
#mc_embed_signup{
    background-color: #fff0 !important;
}
#mc_embed_signup .mc-field-group{
    padding-bottom: 0% !important;
}

#mc_embed_signup h2{
    margin: 0px !important;
}
#mc_embed_signup .brandingLogo{
    display: none !important;
}
</style>
<div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://www.ankushchoubey.com/tdd-backend-example';
      this.page.identifier = 'https://www.ankushchoubey.com/tdd-backend-example';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://ankushchoubey.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
<a class="u-url" href="/tdd-backend-example" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://www.ankushchoubey.com/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Full Stack Developer - Cloud/Microservices</p>
      </div>
    </div>

    <div class="social-links">
<ul class="social-media-list">
<li>
  <a rel="me" href="https://github.com/ankschoubey" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/ankschoubey" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
