<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pre-save Data Validation | Ankush Choubey</title>
<meta name="generator" content="Jekyll v4.1.1">
<meta property="og:title" content="Pre-save Data Validation">
<meta property="og:locale" content="en_US">
<meta name="description" content="It’s imperative to have good data validations in place. Because often, data leads to more bugs even when logic works correctly.">
<meta property="og:description" content="It’s imperative to have good data validations in place. Because often, data leads to more bugs even when logic works correctly.">
<link rel="canonical" href="https://www.ankushchoubey.com/pre-save-data-validation/">
<meta property="og:url" content="https://www.ankushchoubey.com/pre-save-data-validation/">
<meta property="og:site_name" content="Ankush Choubey">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-08-06T00:00:00-05:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Pre-save Data Validation">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-27T14:52:08-06:00","datePublished":"2022-08-06T00:00:00-05:00","description":"It’s imperative to have good data validations in place. Because often, data leads to more bugs even when logic works correctly.","headline":"Pre-save Data Validation","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ankushchoubey.com/pre-save-data-validation/"},"url":"https://www.ankushchoubey.com/pre-save-data-validation/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
<link type="application/atom+xml" rel="alternate" href="https://www.ankushchoubey.com/feed.xml" title="Ankush Choubey">
<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-35993343-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pre-save Data Validation | Ankush Choubey</title>
<meta name="generator" content="Jekyll v4.1.1">
<meta property="og:title" content="Pre-save Data Validation">
<meta property="og:locale" content="en_US">
<meta name="description" content="It’s imperative to have good data validations in place. Because often, data leads to more bugs even when logic works correctly.">
<meta property="og:description" content="It’s imperative to have good data validations in place. Because often, data leads to more bugs even when logic works correctly.">
<link rel="canonical" href="https://www.ankushchoubey.com/pre-save-data-validation/">
<meta property="og:url" content="https://www.ankushchoubey.com/pre-save-data-validation/">
<meta property="og:site_name" content="Ankush Choubey">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-08-06T00:00:00-05:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Pre-save Data Validation">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-27T14:52:08-06:00","datePublished":"2022-08-06T00:00:00-05:00","description":"It’s imperative to have good data validations in place. Because often, data leads to more bugs even when logic works correctly.","headline":"Pre-save Data Validation","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ankushchoubey.com/pre-save-data-validation/"},"url":"https://www.ankushchoubey.com/pre-save-data-validation/"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet">
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css">
<link type="application/atom+xml" rel="alternate" href="https://www.ankushchoubey.com/feed.xml" title="Ankush Choubey">
<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-35993343-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body>
<header class="site-header">

  <div class="wrapper">
<a class="site-title" rel="author" href="/">Ankush Choubey</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
<a class="page-link" href="/core-values-page/">Core Values</a><a class="page-link" href="/philosophy/">Philosophy</a><a class="page-link" href="/resume">Hire me!</a><a class="page-link" href="/search/">Search</a>
</div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <header class="post-header" style="
    display: flex;
    flex-direction: column;
    justify-content: end;"><div style="backdrop-filter: blur(200px); position: absolute; left:0px; padding: 0px 20px;">
    <h1 class="post-title p-name" itemprop="name headline">Pre-save Data Validation</h1>
<p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-08-06T00:00:00-05:00" itemprop="datePublished">
        Aug 6, 2022
      </time>
      • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
    <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i>
      
      <a class="category-tags-link" href="/categories/#data">data</a>
       
      
      <a class="category-tags-link" href="/categories/#clean-code">clean-code</a>
      
      
    </p>
    

    </div>
</header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#only-allows-certain-data">Only allows certain data</a></li>
<li class="toc-entry toc-h1"><a href="#validate-on-frontend">Validate on frontend</a></li>
<li class="toc-entry toc-h1"><a href="#validate-on-the-backend">Validate on the backend</a></li>
<li class="toc-entry toc-h1"><a href="#validate-on-the-database">Validate on the database</a></li>
</ul>
<p>It’s imperative to have good data validations in place. Because often, data leads to more bugs even when logic works correctly.</p>

<p>Data errors can be:</p>
<ol>
  <li>null values in the database or from an external system</li>
  <li>expecting values to be positive by getting negative ones.</li>
  <li>expecting a field to have a specific format but getting something else</li>
</ol>

<p>The only solution to a data error is running data migrations which is an unnecessary overhead.</p>

<p>Therefore, we should ensure that data is validated before it reaches DB.</p>

<h1 id="only-allows-certain-data">
<a class="anchor" href="#only-allows-certain-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Only allows certain data</h1>

<p>You minimize data problems by only allowing it for specific fields.</p>

<p>On a UI, it could be dropdowns, date fields with range, and auto-completion options.</p>

<h1 id="validate-on-frontend">
<a class="anchor" href="#validate-on-frontend" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validate on frontend</h1>

<p>Libraries like <a href="https://formik.org/">formik</a> and <a href="https://github.com/jquense/yup">yup</a> can help perform object and user input validation.</p>

<p>Typescript is only helpful in knowing the exact names of the variable, its type or keys within an object. Since it gets converted to javascript, typescript can’t be used to validate data types.</p>

<h1 id="validate-on-the-backend">
<a class="anchor" href="#validate-on-the-backend" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validate on the backend</h1>

<p>In Java specifically, you have JSR Validators.</p>

<p>Use in all POJOs, especially for incoming request objects and entity objects.</p>

<p>You can also <a href="https://www.baeldung.com/spring-mvc-custom-validator">create custom validators</a>.</p>

<p>Using enums is also an option.</p>

<h1 id="validate-on-the-database">
<a class="anchor" href="#validate-on-the-database" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validate on the database</h1>

<p>This is as important as validating on backend.</p>

<p>SQL already provides a good schema structure that makes it easy for validation. Contraints can be provided in many NoSQLs too.</p>

<p>I faced an issue where mongodb’s upsert operation inserted multiple records instead of updating one. This was a common mongodb issue.</p>

<p>To fix this I used, added <code class="language-plaintext highlighter-rouge">unique=true</code> for compound index I had made.</p>

<p>For DB validation, make sure that you mark things as unique wherever they need to be unique. Similarly, other key related contraints should be used.</p>

  </div>
<!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js" repo="ankschoubey/blog" issue-term="title" label="blogpost-comment" theme="github-light" crossorigin="anonymous" async>
</script><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://www.ankushchoubey.com/pre-save-data-validation/';
      this.page.identifier = 'https://www.ankushchoubey.com/pre-save-data-validation/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://ankushchoubey.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
<a class="u-url" href="/pre-save-data-validation/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://www.ankushchoubey.com/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Full Stack Developer - Cloud/Microservices</p>
      </div>
    </div>

    <div class="social-links">
<ul class="social-media-list">
<li>
  <a rel="me" href="https://github.com/ankschoubey" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/ankschoubey" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
