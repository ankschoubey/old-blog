<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!-- <script>
  for (const iterator of document.getElementsByClassName('page-link')) {
      if (iterator.innerHTML === 'Search'){ iterator.classList.add('search-button'); iterator.title = 'Search';}
      if (iterator.innerHTML === 'Tags'){ iterator.classList.add('tags-button'); iterator.title = 'Tags';}
      if (iterator.innerHTML === 'Side Projects'){ iterator.classList.add('side-project-button'); iterator.title = 'Side Projects';}
  }
</script> --><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="/assets/accordian.js"></script>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Pre-save Data Validation</h1>

    <p class="post-meta post-meta-title"><time class="dt-published post-meta-created-date" datetime="2022-08-06T00:00:00-05:00" itemprop="datePublished">
        Written: Aug 6, 2022
      </time>~<time class="dt-modified post-meta-last-modified-date" datetime="2022-12-27T14:52:08-06:00" itemprop="dateModified">
          Updated: Dec 27, 2022
        </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>    <style>
        .post-tool-bar{
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0px 10px 0px;
            /* border: 1px solid #e8e8e8; */
            border-width: 0px 0px 1px 0px;
        }
        .left-section , .right-section{
            display: flex;
            gap: 8px;
        }

    </style>
    
    <div class="post-tool-bar">
<!-- <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
        AOS.init();
</script> -->

<div class="tag-list">
    
    <a class="tag fa fa-hashtag data" href="/categories/#data">data</a>
    
    <a class="tag fa fa-hashtag clean-code" href="/categories/#clean-code">clean-code</a>
    
</div>
<div class="right-section">
<a id="translate-btn" href="https://www.translatetheweb.com/?ref=TAns&from=&to=hi&a=https%3A%2F%2Fwww.ankushchoubey.com%2F">
    <img src="/images/icons/translate.svg" alt="Translate" style="width:35px">
</a>


<script>
    a = document.getElementById('translate-btn');
    a.setAttribute("href", "https://www.translatetheweb.com/?ref=TAns&from=&to=hi&a=" + window.location.href);
</script><a id="speech-btn">
    <img src="/images/icons/ear.svg" alt="listen" style="width:35px; cursor: pointer;">
</a>

<script>
    speakPost = () => {
        var msg = new SpeechSynthesisUtterance();
        const title = document.querySelector("h1.post-title.p-name").innerText;
        const post = document.querySelector("div.post-content.e-content").innerText
        msg.text = title + '.' + post;
        window.speechSynthesis.speak(msg);
    }
    if ('speechSynthesis' in window) {
        document.getElementById("speech-btn").addEventListener("click", speakPost);
    } else {
        document.getElementById('speech-btn').style.display = 'none';
    }
</script>

<!-- https://www.alebalweb-blog.com/85-text-to-speech-player-with-buttons-play-pause-stop-and-voice-choice.html -->
</div>
      
          
    </div>
    
</header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#only-allows-certain-data">Only allows certain data</a></li>
<li class="toc-entry toc-h1"><a href="#validate-on-frontend">Validate on frontend</a></li>
<li class="toc-entry toc-h1"><a href="#validate-on-the-backend">Validate on the backend</a></li>
<li class="toc-entry toc-h1"><a href="#validate-on-the-database">Validate on the database</a></li>
</ul>
<p>It’s imperative to have good data validations in place. Because often, data leads to more bugs even when logic works correctly.</p>

<p>Data errors can be:</p>
<ol>
  <li>null values in the database or from an external system</li>
  <li>expecting values to be positive by getting negative ones.</li>
  <li>expecting a field to have a specific format but getting something else</li>
</ol>

<p>The only solution to a data error is running data migrations which is an unnecessary overhead.</p>

<p>Therefore, we should ensure that data is validated before it reaches DB.</p>

<h1 id="only-allows-certain-data">
<a class="anchor" href="#only-allows-certain-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Only allows certain data</h1>

<p>You minimize data problems by only allowing it for specific fields.</p>

<p>On a UI, it could be dropdowns, date fields with range, and auto-completion options.</p>

<h1 id="validate-on-frontend">
<a class="anchor" href="#validate-on-frontend" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validate on frontend</h1>

<p>Libraries like <a href="https://formik.org/">formik</a> and <a href="https://github.com/jquense/yup">yup</a> can help perform object and user input validation.</p>

<p>Typescript is only helpful in knowing the exact names of the variable, its type or keys within an object. Since it gets converted to javascript, typescript can’t be used to validate data types.</p>

<h1 id="validate-on-the-backend">
<a class="anchor" href="#validate-on-the-backend" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validate on the backend</h1>

<p>In Java specifically, you have JSR Validators.</p>

<p>Use in all POJOs, especially for incoming request objects and entity objects.</p>

<p>You can also <a href="https://www.baeldung.com/spring-mvc-custom-validator">create custom validators</a>.</p>

<p>Using enums is also an option.</p>

<h1 id="validate-on-the-database">
<a class="anchor" href="#validate-on-the-database" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validate on the database</h1>

<p>This is as important as validating on backend.</p>

<p>SQL already provides a good schema structure that makes it easy for validation. Contraints can be provided in many NoSQLs too.</p>

<p>I faced an issue where mongodb’s upsert operation inserted multiple records instead of updating one. This was a common mongodb issue.</p>

<p>To fix this I used, added <code class="language-plaintext highlighter-rouge">unique=true</code> for compound index I had made.</p>

<p>For DB validation, make sure that you mark things as unique wherever they need to be unique. Similarly, other key related contraints should be used.</p>

  </div>
  <!-- https://david.elbe.me/jekyll/2015/06/20/how-to-link-to-next-and-previous-post-with-jekyll.html -->

<div class="PageNavigation">
    
      <a class="prev" href="/maven-dependency-upgrade/">« Tips on fixing and upgrading Maven Dependencies</a>
    
    
      <a class="next" href="/mutation-testing/">Mutation Testing »</a>
    
  </div>

<style>
    .PageNavigation {
  font-size: 14px;
  display: block;
  width: auto;
  overflow: hidden;
}

.PageNavigation a {
  display: block;
  width: 50%;
  float: left;
  margin: 1em 0;
}

.PageNavigation .next {
  text-align: right;
}
</style>
<!-- from https://github.com/utterance/utterances -->
<!-- <script src="https://utteranc.es/client.js"
        repo="ankschoubey/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script> -->

  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://www.ankushchoubey.com/pre-save-data-validation/';
      this.page.identifier = 'https://www.ankushchoubey.com/pre-save-data-validation/';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://ankushchoubey.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
<a class="u-url" href="/pre-save-data-validation/" hidden></a>
</article>
</head></html>
