<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://www.ankushchoubey.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://www.ankushchoubey.com/" rel="alternate" type="text/html" /><updated>2023-03-22T01:46:32-05:00</updated><id>https://www.ankushchoubey.com/feed.xml</id><title type="html">Ankush Choubey</title><subtitle>Full Stack Developer - Cloud/Microservices</subtitle><entry><title type="html">Implementing an OAuth Server Manually</title><link href="https://www.ankushchoubey.com/v1/implementing-oauth" rel="alternate" type="text/html" title="Implementing an OAuth Server Manually" /><published>2023-03-22T00:00:00-05:00</published><updated>2023-03-22T15:52:08-05:00</updated><id>https://www.ankushchoubey.com/v1/v1-implementing-oauth-server</id><content type="html" xml:base="https://www.ankushchoubey.com/v1/implementing-oauth"><![CDATA[<p>This blogpost will cover what OAuth is and how I went about implementing OAuth. It does not include theorotical details. It includes practical questions that lead me to the implementation.</p>

<p>When you read a question, you can search for it yourself. I have provided all the resources that I used along the way below too.</p>

<p>I‚Äôll explain OAuth in layman‚Äôs terms in the beginning and then go on to explain it in more technical terms.</p>

<p>OAuth is easier to implement than developers think. There are a lot of jargons involved. But you‚Äôll find at its core it‚Äôs very easy and cost-effective.</p>

<h1 id="what-is-oauth-and-where-it-is-used">What is OAuth? And where it is used?</h1>

<p>OAuth is a protocol for allowing access to a user‚Äôs data to a third party app.</p>

<p>OAuth is not login. OAuth expects the user is logged in and has allowed the access.</p>

<p>You may have seen screen pages like these where you allow one application to access data from your Google account. This is done via OAuth.</p>

<p><img src="/images/implementing-oauth.png" alt="image.png" /></p>

<p>The above image is from redirecting to ‚Äúauthorize‚Äú url.</p>

<h1 id="how-is-oauth-different-from-login-and-how-does-it-work">How is OAuth different from Login? And how does it work</h1>

<p>A normal login just requires username and password.</p>

<p>OAuth is a step that happens after login. If the user is not logged in OAuth step won‚Äôt happen.</p>

<p>For example, suppose you create an app called ‚ÄúChain Mailer‚Äú and you want access to the user‚Äôs Gmail data.</p>

<p>You initiate the OAuth flow, this means you redirect the user to Gmail with some special parameters. If the user is not logged in, he is asked to log in into Gmail but Gmail itself. Our ‚ÄúChain Mailer‚Äù app has no control over what Gmail does or what the user does. We have just redirected to Gmail.</p>

<p>If the user logs in they‚Äôll see the permissions page. And if they accept, the <code class="language-plaintext highlighter-rouge">3-Legged OAuth flow</code> would happen between Gmail and our Application.</p>

<p>Note: How OAuth Flow only happened after user logged in into the service.</p>

<p>After the <code class="language-plaintext highlighter-rouge">3-Legged OAuth Flow</code> our application would receive a special token called <code class="language-plaintext highlighter-rouge">Authorization Token</code>. We can use this token while accessing data from Gmail.</p>

<p>The <code class="language-plaintext highlighter-rouge">Authorization Token</code> would include information that we have the permission to access the data.</p>

<p>Note: From here on things would get technical</p>

<h1 id="how-i-implemented-the-oauth-server-myself">How I implemented the OAuth Server myself</h1>

<p>I‚Äôll split the next parts into:</p>

<ol>
  <li>Learning Phrase</li>
  <li>Coding Phrase</li>
  <li>Nuances</li>
</ol>

<h2 id="learning-phrase">Learning Phrase</h2>

<p>Before implementing OAuth Server, I had done the <code class="language-plaintext highlighter-rouge">3-Legged OAuth Flow</code> with another service myself. So, I knew what the <code class="language-plaintext highlighter-rouge">3-Legged</code> flow is.</p>

<p>This is the first place to start learning about OAuth.</p>

<p>The questions you may ask here is:</p>

<ol>
  <li>What is OAuth?</li>
  <li>What is the three legged OAuth flow.</li>
  <li>How to use the access token. ‚Üí Using the access token by adding a ‚ÄúAuthorization‚Äú Header with value ‚Äúbearer {authorizationToken}‚Äú</li>
</ol>

<p>To implement it, I started reading up on Google, but I found it very challenging. Here‚Äôs how I learn‚Äôt OAuth and all the security concepts I needed to learn.</p>

<ol>
  <li>I started watching a YouTube playlist this gave me a broad idea about the implementation.</li>
  <li>I asked ChatGPT how to implement an OAuth server.
    <ol>
      <li>ChatGPT gave me useful responses that I was able to ask followup questions to.</li>
      <li>My questions included:
        <ol>
          <li>How to implement an OAuth server.</li>
          <li>What is JWT token?</li>
          <li>How to I validate a JWT Token?</li>
          <li>What is RSA algorithm?
            <ol>
              <li>I further jumped into learning about RSA via YouTube.</li>
              <li>Here‚Äôs my post on RSA: <a href="https://www.ankushchoubey.com/v1/rsa">RSA Algorithm</a></li>
            </ol>
          </li>
          <li>What‚Äôs JWK?</li>
          <li>What‚Äôs the difference between JWE and JWS?</li>
          <li>How to define different scopes?</li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

<p>These gave me a basic idea of what to do.</p>

<p>I realized that I just need to create a 3-endpoints and one permissions page.</p>

<p>The Authentication (Login) is already handled. The permissions page comes one later after the Login one.</p>

<h2 id="implementation-phase">Implementation Phase</h2>

<p>With OAuth multiple third party application can register and access our service.</p>

<p>This means I needed to store information about multiple applications.</p>

<p>I created a DB record called OAuthClient where I stored</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">clientId</code> - A unique id given to the external application</li>
  <li><code class="language-plaintext highlighter-rouge">hashedClientSecret</code> (a hashed version of client secret. Similar to how password is hashed and saved.)</li>
  <li><code class="language-plaintext highlighter-rouge">scopes</code> (permissions that are to be provided to application)</li>
  <li><code class="language-plaintext highlighter-rouge">redirectUri</code> (uri where I would have to redirect).</li>
</ul>

<p>I would generate a clientId, clientSecret and add in scopes and provide these data to third party app.</p>

<hr />

<p>I created another DB record where I store information about the token given. I called it <code class="language-plaintext highlighter-rouge">OAuthToken</code>. This would include the following.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">clientId</code></li>
  <li><code class="language-plaintext highlighter-rouge">code</code> ‚Üí this is a temporary code that would be resent from the external app to my oauth server during stage 3 of 3-legged Oauth Flow.</li>
  <li><code class="language-plaintext highlighter-rouge">accessTokenGiven</code> ‚Üí A boolean value representing if the OAuth token was already granted for the particular code.</li>
</ul>

<p>Using these, I was able to issue OAuth tokens.</p>

<hr />

<p>I also needed JWT token generation.</p>

<p>I used a library to create JWTs and included all the information related to the user application and scope.</p>

<p>For generating JWTs I had to learn what <code class="language-plaintext highlighter-rouge">PEM</code> file is.</p>

<hr />

<p>I also had to create a public <code class="language-plaintext highlighter-rouge">JWK endpoint</code> which my api gateway would access to validate the token. <code class="language-plaintext highlighter-rouge">JWK</code> is a standard way of sharing public keys for JWT token.</p>

<p>I also added a record for scopes. Which was something like</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">scope</code> ‚Üí unique name of the scope</li>
  <li><code class="language-plaintext highlighter-rouge">description</code> ‚Üí unique description of the scope used to show user what to do in the permissions page.</li>
</ul>

<p>Here‚Äôs my post on how I choose to define scopes: <a href="https://www.ankushchoubey.com/v1/oauth-scopes">Defining Scopes for your OAuth Service</a></p>

<h1 id="nuances">Nuances</h1>

<h2 id="oauth-works-protocol-is-snake-cased">OAuth works protocol is snake cased</h2>

<p>I initially implemented all endpoints as camel case. But it did not work. Then I had to modify it to snake case.</p>

<h1 id="oauth-formats">OAuth formats</h1>

<p>Formats within OAuth protocol are very fixed. Certain endpoints accept and return data in a particular format only and they don‚Äôt have randomness.</p>

<p>For example, the <code class="language-plaintext highlighter-rouge">token</code> endpoint would always be in the following format.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"authorize_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{jwtToken}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"refrest_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{token}"</span><span class="p">,</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>We can‚Äôt extend the format by adding our own stuff. But mandatory things would be preserved as it is. For that I had to read up the main OAuth specs a few times.</p>

<h2 id="my-thoughts">My thoughts</h2>

<p>After implementing OAuth server myself, I feel confident about other protocols. Protocols may seem too technical but at their core they are really easy.</p>

<p>Implementing OAuth helped me understand and get better at computer security. And also, helped me step into a much better principle developer role.</p>

<h2 id="resources">Resources</h2>

<p>Jump around these</p>

<p><a href="https://www.youtube.com/watch?v=t18YB3xDfXI">An Illustrated Guide to OAuth and OpenID Connect</a></p>

<p><a href="https://www.youtube.com/watch?v=996OiexHze0">OAuth 2.0 and OpenID Connect (in plain English)</a></p>

<p><a href="https://www.youtube.com/playlist?list=PL1Nml43UBm6dOj4UuH-7a9e3wO6eL2SCi">OAuth 2.0 tutorial Playlist </a></p>

<p>ChatGPT</p>

<p><a href="https://www.rfc-editor.org/rfc/rfc6749">Main Spec: The OAuth 2.0 Authorization Framework</a></p>

<h3 id="my-blogposts">My Blogposts</h3>

<p><a href="https://www.ankushchoubey.com/v1/oauth-scopes">Defining Scopes for your OAuth Service</a></p>

<p><a href="https://www.ankushchoubey.com/v1/rsa">RSA Algorithm</a></p>]]></content><author><name></name></author><category term="security" /><category term="oauth" /><summary type="html"><![CDATA[Implementing OAuth server is easier than it looks and it saves money in the long run.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://www.ankushchoubey.com/images/implementing-oauth.png" /><media:content medium="image" url="https://www.ankushchoubey.com/images/implementing-oauth.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Stating the Truth When It Could Hurt</title><link href="https://www.ankushchoubey.com/v1/truth/state-truth-when-it-hurts" rel="alternate" type="text/html" title="Stating the Truth When It Could Hurt" /><published>2023-03-16T00:00:00-05:00</published><updated>2023-03-16T15:52:08-05:00</updated><id>https://www.ankushchoubey.com/v1/truth/v1-state-the-truth-even-when-its-hard</id><content type="html" xml:base="https://www.ankushchoubey.com/v1/truth/state-truth-when-it-hurts"><![CDATA[<p>I often talk about truth and telling the truth all time time.</p>

<p>Many people agree with me that it‚Äôs a good thing to tell the truth.</p>

<p>But then comes parts where they start compromising telling the truth.</p>

<p>For example, they say I don‚Äôt want to hurt them so I won‚Äôt tell the truth there.</p>

<p>Or that ‚Äúhinting‚Äù is same as telling the truth.</p>

<p>But truth isn‚Äôt something that you hide. Truth is actually not even something that you ‚Äúsay‚Äù.</p>

<p>It‚Äôs better to use a different vocabulary. State the truth.</p>

<p>We know that we don‚Äôt tell the facts. We state the facts.</p>

<p>Similarly, we state the truth. Meaning the truth passes through as it is.</p>

<p>For example, someone asks how we are doing?</p>

<p>Instead of saying I am doing really good. We say, I am better. If they drill down, I share what is really going on.</p>

<p>If someone asks why wasn‚Äôt this software delivery on time, I say, I haven‚Äôt been doing so well lately. Or that I haven‚Äôt been focused lately.</p>

<p>This is combined with honest action, to finish the work on time.</p>

<h2 id="a-recent-situation">A recent situation</h2>

<p>There is another situation I encountered. And it‚Äôs likely where many people are likely to lie.</p>

<p>I was in an Uber a few days ago. And the driver asked if he could take us offline. Offline means without the app. The driver would cancel the booking. And take us to the same destination without Uber. And I would have to pay him the same money. This way, the driver would not have his pay cut to Uber.</p>

<p>At the time, I did think Uber is a big company. But is it right to cheat against the big company. I thought let‚Äôs lie to Uber. I agreed to go offline. He canceled the booking and I snuck a deal to get 50 Rs. off the ride.</p>

<p>Pretty sweet. Now, the person who had booked the ride started getting calls from Uber. In the Uber app it showed that their is a cancelling fee of 38.10 Rs.</p>

<p>I thought Hmm. So, even after snugging a deal with the driver.</p>

<p>I got 11.90 Rs off if I add up the cancelling fee. That‚Äôs pretty bad.</p>

<p>The person who booked kept getting multiple calls from Uber to pay up.</p>

<p>Hmm. Uber help allowed selecting ‚ÄúMy driver asked me to book without Uber‚Äù. I thought for a minute, what I should do. The person who had booked the Uber said that the Driver might lose his Job. I thought for a minute. And then decided I should side with the truth. I explained to the person that we should go with the truth and click the ‚ÄúMy driver asked me to book without Uber‚Äù option. We did get out money back. 38Rs isn‚Äôt a big number. It‚Äôs about half a dollar.</p>

<p>Here why I choose ‚ÄúMy driver asked me to book without Uber‚Äù.</p>

<p>The driver who did asked us for going offline, might also be convincing the same to other riders. And they maybe getting cancelling fees too.</p>

<p>Uber is a business built by hard working people. If they are providing a platform to earn, they should get the reward. The driver wouldn‚Äôt even have a job if Uber didn‚Äôt provide for it.</p>

<p>So, it didn‚Äôt make long term sense for the driver to try to betray his parent company.</p>

<p>If I side with the truth, the possibility that the driver no longer repeats the mistakes is created. It maybe possible that the driver chooses to still repeat the same mistakes. But at a minimum, he has an opportunity to choose a truthful path. And everything he does is truthful.</p>

<p>I also thought about how do court judges and people in administration do justice. Even though they know what is truth, they still may have humanly feeling to the person that may not have things in their favor. What should a judge do.</p>

<p>‚ÄúWe side with the truth‚Äù</p>

<p>Always. In every situation. No matter how big or small.</p>

<p>If I had told the truth with the intent of doing good. I would have explained the driver that the consequence of his actions. I should have denied his proposal. And that way, I would have given him a perspective that would have led him to a truthful path.</p>

<p>Since, customer is the king. Uber didn‚Äôt charge me anything. But it‚Äôs still weird to think that I was involved too.</p>

<p>For Uber the company, it costed 750 Rs. The money adds up to what they pay their employees. And everyone‚Äôs home runs.</p>

<ul>
  <li>To me it costed 700Rs. That‚Äôs fine.</li>
  <li>To the person who booked the uber. It costed multiple phone calls.</li>
  <li>To the driver may costed his and his family‚Äôs earning.</li>
</ul>

<h2 id="truth-with-truthful-action-passes-through-without-hurting-us">Truth with truthful action passes through without hurting us.</h2>

<p>If the driver had been truthful, he wouldn‚Äôt have had to face this situation. And neither would we.</p>

<p>If I had been truthful, both we and the driver wouldn‚Äôt have faced the situation.</p>

<p>Because truth passes through without hurting us.</p>

<p>Truth passes through can be imagined and us just standing and truth passing across us. If we are lying, we engage against truth, and it hurts us. If we don‚Äôt engage against the truth and let is pass, it doesn‚Äôt hurt us.</p>]]></content><author><name></name></author><category term="non-technical" /><category term="truth" /><category term="mature" /><summary type="html"><![CDATA[Why we should use the vocabulary 'stating'. And how can we state the truth.]]></summary></entry><entry><title type="html">You are really doing BDD when</title><link href="https://www.ankushchoubey.com/v1/you-are-following-good-bdd-when" rel="alternate" type="text/html" title="You are really doing BDD when" /><published>2023-03-11T00:00:00-06:00</published><updated>2023-03-11T14:52:08-06:00</updated><id>https://www.ankushchoubey.com/v1/v1-you-are-following-good-bdd-when</id><content type="html" xml:base="https://www.ankushchoubey.com/v1/you-are-following-good-bdd-when"><![CDATA[<p>You are really doing BDD if you answer yes to these questions:</p>

<ul>
  <li>BDD specifications drive the design of VDIs, prioritization and development.
    <ul>
      <li>Specs first VDIs later.</li>
      <li>Specs first Development later.</li>
    </ul>
  </li>
  <li>Any new decision made about the product functionality leads to an updated spec file.
    <ul>
      <li>Therefore the spec file is an integral part of every meeting.</li>
    </ul>
  </li>
  <li>
    <p>Any dispute or confusion about what was decided is resolved by reviewing the spec file.</p>
  </li>
  <li>
    <p>You remember the specification files because you have read, modified and used them so much.</p>
  </li>
  <li>
    <p>Everyone involved in the product life cycle (including non-technical people) knows what BDD is and has access to spec file.</p>
  </li>
  <li>When any new person who wants to understand the product is given the BDD file to understand it.</li>
</ul>]]></content><author><name></name></author><category term="bdd" /><summary type="html"><![CDATA[You are really doing BDD if you answer yes to these questions:]]></summary></entry><entry><title type="html">Economic Systems and Macroeconomics - Crash Course Economics - 3</title><link href="https://www.ankushchoubey.com/crash-course/econ/3" rel="alternate" type="text/html" title="Economic Systems and Macroeconomics - Crash Course Economics - 3" /><published>2023-03-11T00:00:00-06:00</published><updated>2023-03-11T14:42:15-06:00</updated><id>https://www.ankushchoubey.com/crash-course/econ/crash-course-econ-3</id><content type="html" xml:base="https://www.ankushchoubey.com/crash-course/econ/3"><![CDATA[<p><img src="https://www.youtube.com/watch?v=B43YEW2FvDs" alt="" /></p>

<p>Like rolling stones tell us, we can‚Äôt get all that we want. because there are limited resources so we have to make choices.
***</p>

<p>There are 3 types of resource according to Karl Marx.</p>

<ul>
  <li>Land</li>
  <li>Labor</li>
  <li>Capital</li>
</ul>

<p>And economic system allows for</p>

<ul>
  <li>What we produce?</li>
  <li>How we produce it?</li>
  <li>Who gets it?</li>
</ul>

<p>There are two types of Economy based on who controls the resources and what the system allows.</p>

<ul>
  <li>Command Economy</li>
  <li>Free Market Economy</li>
</ul>

<hr />

<p>Adam Smith said</p>

<blockquote>
  <p>It‚Äôs not from the benevolance of the butcher, the brewer or the baker that we expect our dinner, but from their regard to their own self interest.</p>
</blockquote>

<hr />

<p>Command Economy is controlled by the government. It decides what to do.</p>

<p>Free Market Economy is where a companies decides what they can produce based on the profits they receive.</p>

<hr />

<p><strong>Invisible Hand</strong>: The unintended social benefit resulting from individual actions.</p>

<p>Free Market Economy leads to ‚Äúinvisible hand‚Äù where you as a result of paying for something that leads to profit good things happen.</p>

<p>For example, if 1 of 2 competing car brands make better products, they‚Äôll have all the capital and incentives of the free market i.e. more profits. Thus to compete the other brand has to innovate. #invisibleHand</p>

<p>Similar is not the case with command economy. Government can make a car and have no competition but it doesn‚Äôt have any special need to innovate.</p>

<hr />

<p>Planned/Command Economy is not all bad. Because there are many things Free Market economy can‚Äôt handle.</p>

<p>Things like Security, Roads, Education, etc are all things needed for a good functioning free market economy but can only be provided via Government i.e. Command Economy.</p>

<p>Also, government intervine where Free Markets are failing. For example, it can provide regulation on car safety standards or how much pollution is allowed or how should the workers be paid. All of these, saves more money in the long run.</p>

<p>North Korea is a command economy. New Zealand is a free market economy with very few taxes. Most economies of the world are mixed.</p>

<p>And many economies are and have been changing. For example, Canada üá®üá¶ went from mostly free market to providing Universal Healthcare.</p>

<p>While, China üá®üá≥ went from mostly socialist economy to free market.</p>

<p>Modern economies are neither completely free or planned, there‚Äôs a spectrum of government involvement.</p>

<p>We should not fix ourselves to one ideology or another and rather focus on what get‚Äôs the job done at the time.</p>

<blockquote>
  <p>It doesn‚Äôt matter if a cat is black or white, if it caches mice, it is a good cat.
~ Deng Xiaoping</p>
</blockquote>

<hr />

<p>While we could absolutely abolish many things like poverty with a command economy, remember that in economic terms we always have trade-offs because we always have scares limited resources.</p>

<p>So, spending money to abolish poverty could lead to less money spend on health care or less money on security so a war that leads to more poverty!</p>

<hr />

<h2 id="circular-flow-model">Circular Flow Model</h2>

<p>There is also a circle ‚≠ïÔ∏è where</p>

<p>Indivuals Purchase from Businesses. This way business get‚Äôs money.</p>

<p>To purchase from business, individual need money.</p>

<p>so individually provide their labor to the business. So individuals now have money.</p>

<p>Government steps in between to provide facilities to both businesses and individuals. And to get their money they tax both individuals and businesses.</p>

<p>wealthIsAlwaysTransfered because only government can generate more money. - Andrew Tate</p>]]></content><author><name></name></author><category term="crash-course" /><category term="econ" /><category term="summary" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">One service should serve multiple mediums (REST, Kafka, gRPC, etc)</title><link href="https://www.ankushchoubey.com/v1/separate-service/" rel="alternate" type="text/html" title="One service should serve multiple mediums (REST, Kafka, gRPC, etc)" /><published>2023-03-10T00:00:00-06:00</published><updated>2023-03-10T14:52:08-06:00</updated><id>https://www.ankushchoubey.com/v1/v1-separate-domain-and-connector</id><content type="html" xml:base="https://www.ankushchoubey.com/v1/separate-service/"><![CDATA[<p>In a previous post, I talked about how we should separate Domain Layer from Technical code. Here‚Äôs another version of the same with respect to service.</p>

<p>A Service that handles tasks of a RestController isn‚Äôt very different from a rest controller.</p>

<p>We should separate out the Service from the Rest Controllers because we want to be able to re-use the service.</p>

<p>But if Service handles rest rest controller responses, it isn‚Äôt very different.</p>

<h2 id="an-ideal-service">An ideal service</h2>

<p><img src="https://docs.google.com/drawings/d/e/2PACX-1vT3KH3qfLmMQ0DDGtQL8uyol8YhCWqBEc1DJxuGJ5vS9gdNxYKf7vkIgb2ETVHrZOocCTJv4kAFDUtU/pub?w=1300&amp;h=740" alt="https://docs.google.com/drawings/d/e/2PACX-1vT3KH3qfLmMQ0DDGtQL8uyol8YhCWqBEc1DJxuGJ5vS9gdNxYKf7vkIgb2ETVHrZOocCTJv4kAFDUtU/pub?w=1300&amp;h=740" /></p>

<p>Here‚Äôs how you separate out connectors from the business logic.</p>

<p>Connector are mediums we use to communicate with the the outside world. Examples of connectors are Rest API connector (like RestController or RouterFunction+it‚Äôs Handler), Kafka Connector.</p>

<p>Services are code that implement the business logic.</p>

<p>All conversion from Entity to DTO or DTO to entity (i.e handle the request event and provide response in format needed by the client) should be handles at Rest API Connector.</p>

<p>The Rest API Connector is responsible for calling the service method between the request and the response.</p>

<p>For the service method, REST API connector is a downstream. So, it does not care about what format of data it sends. It‚Äôs just responsible for executing the business logic and sending the data in whatever is it‚Äôs format.</p>]]></content><author><name></name></author><category term="web-development" /><category term="ddd" /><category term="clean-code" /><summary type="html"><![CDATA[Your main business logic resides in your service. All other things are connectors]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://docs.google.com/drawings/d/e/2PACX-1vT3KH3qfLmMQ0DDGtQL8uyol8YhCWqBEc1DJxuGJ5vS9gdNxYKf7vkIgb2ETVHrZOocCTJv4kAFDUtU/pub?w=1300&amp;amp;h=740" /><media:content medium="image" url="https://docs.google.com/drawings/d/e/2PACX-1vT3KH3qfLmMQ0DDGtQL8uyol8YhCWqBEc1DJxuGJ5vS9gdNxYKf7vkIgb2ETVHrZOocCTJv4kAFDUtU/pub?w=1300&amp;amp;h=740" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Specialization and Trade - Crash Course Economics - 2</title><link href="https://www.ankushchoubey.com/crash-course/econ/2" rel="alternate" type="text/html" title="Specialization and Trade - Crash Course Economics - 2" /><published>2023-03-04T00:00:00-06:00</published><updated>2023-03-04T14:42:15-06:00</updated><id>https://www.ankushchoubey.com/crash-course/econ/crash-course-econ-2</id><content type="html" xml:base="https://www.ankushchoubey.com/crash-course/econ/2"><![CDATA[<p><img src="https://www.youtube.com/watch?v=NI9TLDIPVcs" alt="" /></p>

<p>Adam Grant was the person who created the wealth of nations. He concluded that specialization and trading are better for everyone involved.</p>

<p>If you don‚Äôt specialize and trade, you‚Äôll have to do everything yourself.</p>

<p>For example in the case of pizza, you‚Äôll have to farm wheat, they make an oven and then even cook.</p>

<p>Instead, by specializing everyone‚Äôs opportunity cost improves.</p>

<p>The PPF profit possibility frontier helps understand the relationship between producing two products,</p>

<p>For example, if the us is producing 500 planes and it could use the same effort to produce 2000 shoes,
For every 1 plane they produce, they leave our 4 shoes.</p>

<p>If China can produce 100 planes or 800 shoes with the same effort, china for every 1 plane produced, leaves out 800 shoes.</p>

<p>It may seem that the US is better off here and should not trade, but if the US trades planes for shoes, they‚Äôll be better off (need to learn here)</p>

<hr />

<p>Point outside the PPF curve is an impossibility
The point inside the PPF curve is inefficiency.
How do you maximize efficiency?
By specializing and trading.</p>

<hr />

<p>Self-sufficiency is inefficiency</p>

<hr />

<p>Wellness can be predicted by a variety of many economic predictors like GDP per capita, employee, and ent rate, by this we see statistically, most improvements came after Industrial Revolution.</p>

<p>We also see that countries that are voluntarily or involuntarily cut off from trading with other countries. like Iran Zimbabwe %</p>

<p>And countries like India and China that opened up the economy and started trading have been experiencing significant growth in %</p>

<p>Individuals and countries should specialize and do things that they have a competitive advantage in and then trade with others in what they have a competitive advantage in. This trade is mutually beneficial</p>]]></content><author><name></name></author><category term="crash-course" /><category term="econ" /><category term="summary" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">Intro to Economics - Crash Course Econ 1</title><link href="https://www.ankushchoubey.com/crash-course/econ/1" rel="alternate" type="text/html" title="Intro to Economics - Crash Course Econ 1" /><published>2023-03-04T00:00:00-06:00</published><updated>2023-03-04T14:42:15-06:00</updated><id>https://www.ankushchoubey.com/crash-course/econ/crash-course-econ-1</id><content type="html" xml:base="https://www.ankushchoubey.com/crash-course/econ/1"><![CDATA[<p><img src="https://www.youtube.com/watch?v=3ez10ADR_gM" alt="" /></p>

<p>Economics is not just a study of money or the stock exchange.</p>

<p>Economics is the study of people and their choices.</p>

<p>And this is based on two fundamental assumptions of Economics.</p>

<ul>
  <li>Scarcity</li>
  <li>Opportunity Cost</li>
</ul>

<p>You could be doing one thing but you are choosing to do something else. In that sense, you believe that doing one is a better use of your time than another. Therefore, your opportunity cost of one is greater than another.</p>

<p>Scarcity means there is a limited supply of resources.</p>

<hr />

<p>Economics is when people make choices. When a college student decides to pick major A over Major B.</p>

<hr />

<p>Many people believe that if you just put more money into healthcare, it would improve. But in many cases what we need is the right incentive. So, economics is also a study of incentives.</p>

<p>For example, you could provide the college with an incentive on the number of enrollments. But then college would play it to just enroll.</p>

<p>Then you modify it to incentivize the number of graduates, then you suddenly have colleges just passing people or lowering difficulty or only admitting smart kids.</p>

<p>So, it‚Äôs very important to get incentives right. Because wrong incentives can backfire.</p>

<hr />

<p>Most economists are in Microeconomics. Whether to launch the business snow or later? What to do when a competitor does x?</p>

<p>Macro is the study of a Nation and its decisions like inflation, unemployment, etc.</p>

<hr />

<p>Both Governments and the Free Market support each other. One can‚Äôt function without the other.</p>

<hr />

<p>There is always an opportunity cost. If you don‚Äôt want road accidents, you could remove all cards from the road. But you understand the opportunity cost and decide one is better than the other.</p>]]></content><author><name></name></author><category term="crash-course" /><category term="econ" /><category term="summary" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">The only differences between external_apps and internal_features in a plugin architecture</title><link href="https://www.ankushchoubey.com/v1/internal-vs-external-plugin" rel="alternate" type="text/html" title="The only differences between external_apps and internal_features in a plugin architecture" /><published>2023-03-03T00:00:00-06:00</published><updated>2023-03-03T14:52:08-06:00</updated><id>https://www.ankushchoubey.com/v1/v1-difference-between-third-party-and-first-party</id><content type="html" xml:base="https://www.ankushchoubey.com/v1/internal-vs-external-plugin"><![CDATA[<h2 id="from-a-users-perspective">From A User‚Äôs Perspective</h2>

<p>First Party¬†<strong>Default</strong>¬†Apps are just product features.</p>

<p>First Party¬†<strong>Installable</strong>¬†Apps are apps that can be installed by the user.</p>

<ul>
  <li>These apps are not enabled by default</li>
  <li>These are provided by default.</li>
  <li>A user won‚Äôt even know that these are treated as an app by the platform company.</li>
</ul>

<p><strong>Third-party</strong>¬†apps are created by third-party developers and can extend the core functionality of the first-party app.</p>

<ul>
  <li>These apps are not enabled by default.</li>
</ul>

<hr />

<h2 id="code-perspective">Code Perspective</h2>

<p><strong>These two types of apps are the same</strong>, except the first-party app doesn‚Äôt need Authentication to access Platform data, while the third-party app does.</p>

<p>A third-party app may utilize all capabilities that the plugin platform provides unless some capabilities are reserved for first-party apps.</p>

<p>In the previous post, I explained how we could define scopes for our resource would work.</p>

<p>I took the example of movies where an app is using 2 scopes: ‚Äú<strong>read:movies</strong>‚Äù and ‚Äú<strong>read:userinfo</strong>‚Äù</p>

<p>Let‚Äôs call this app, an external_app.</p>

<p>Now suppose we have an internal feature, which uses the same endpoints that ‚Äúread:movies‚Äù and ‚Äúread:userinfo‚Äù uses.</p>

<p>The only difference between external_app and the internal feature would be that the external_app will use OAuth and scopes to get access to the resource. While the internal_feature would not have to ask for permission to access the resource.</p>

<p>This means, once you create a scope, it‚Äôs fixed.</p>

<p>And this simplifies your development a lot.</p>

<hr />

<p>So, therefore, we need not treat internal features and external apps very differently.</p>

<p>At the platform level, both internal_feature and the external_app are just apps.</p>]]></content><author><name></name></author><category term="architecture" /><category term="plugin" /><summary type="html"><![CDATA[From A User‚Äôs Perspective]]></summary></entry><entry><title type="html">Defining Scopes for your OAuth Service</title><link href="https://www.ankushchoubey.com/v1/oauth-scopes" rel="alternate" type="text/html" title="Defining Scopes for your OAuth Service" /><published>2023-03-03T00:00:00-06:00</published><updated>2023-02-01T14:52:08-06:00</updated><id>https://www.ankushchoubey.com/v1/v1-oauth-scopes</id><content type="html" xml:base="https://www.ankushchoubey.com/v1/oauth-scopes"><![CDATA[<p>Here‚Äôs my thinking on how we should design scopes for OAuth. And how many a proper REST API could simplify the process.</p>

<hr />

<p>In a rest API, we have resources. Our resources are usually accessed with just a noun.</p>

<p>so,</p>

<p><code class="language-plaintext highlighter-rouge">GET</code> <code class="language-plaintext highlighter-rouge">/movies</code> to get all movies</p>

<p><code class="language-plaintext highlighter-rouge">GET</code> <code class="language-plaintext highlighter-rouge">/movies/{movieId}</code> to get a specific movie</p>

<p><code class="language-plaintext highlighter-rouge">PUT</code> <code class="language-plaintext highlighter-rouge">/movies</code> to modify a movie</p>

<p><code class="language-plaintext highlighter-rouge">POST</code> <code class="language-plaintext highlighter-rouge">/movies</code> to add a new movie</p>

<p><code class="language-plaintext highlighter-rouge">DELETE</code> <code class="language-plaintext highlighter-rouge">/movies/{movieID}</code> to delete a movie</p>

<hr />

<p>Our Outh scopes are a restriction on resources</p>

<p>so, we would have scopes for <code class="language-plaintext highlighter-rouge">movies</code> resource.</p>

<p>We can append this with the kind of method that can be run on the resource.</p>

<hr />

<p>For example:</p>

<p><code class="language-plaintext highlighter-rouge">read:movies</code> -&gt; allows <code class="language-plaintext highlighter-rouge">GET</code> calls on <code class="language-plaintext highlighter-rouge">/movies</code> REST API resource</p>

<p><code class="language-plaintext highlighter-rouge">write:movies</code> ‚Üí allows <code class="language-plaintext highlighter-rouge">POST</code> calls on the <code class="language-plaintext highlighter-rouge">/movies</code> resource.</p>

<p><code class="language-plaintext highlighter-rouge">read:userinfo</code> ‚Üí allows <code class="language-plaintext highlighter-rouge">GET</code> calls on the <code class="language-plaintext highlighter-rouge">/userinfo</code> resource</p>

<hr />

<p>When the app is submitted to our ‚ÄúApp Store‚Äú, the app developer declares an app, they are using a particular scope.</p>

<p>For example, let‚Äôs say an App that shows user recommendations has asked for <code class="language-plaintext highlighter-rouge">read:movies</code>, <code class="language-plaintext highlighter-rouge">write:movies and</code> read:userinfo<code class="language-plaintext highlighter-rouge"> </code>.</p>

<p>The app developer has declared why they use each of the scopes. While declaring, they decide they aren‚Äôt using the <code class="language-plaintext highlighter-rouge">write:movies</code> scope.</p>

<p>So, they remove it. Or while reviewing the app submission application, the App Store platform rejects the request for accepting <code class="language-plaintext highlighter-rouge">write:movies</code> and asks for more clarifications.</p>]]></content><author><name></name></author><category term="security" /><category term="oauth" /><summary type="html"><![CDATA[Here‚Äôs my thinking on how we should design scopes for OAuth. And how many a proper REST API could simplify the process.]]></summary></entry><entry><title type="html">Migrating DB smoothly with a migration script</title><link href="https://www.ankushchoubey.com/db-migration-script/" rel="alternate" type="text/html" title="Migrating DB smoothly with a migration script" /><published>2023-03-03T00:00:00-06:00</published><updated>2023-03-03T14:52:08-06:00</updated><id>https://www.ankushchoubey.com/db-migration-script</id><content type="html" xml:base="https://www.ankushchoubey.com/db-migration-script/"><![CDATA[<p>If you are transferring from one DB to another and want to make sure it happens properly, this is the mechanism you can use.</p>

<p>The same mechanism could be used to migrate multiple tables. And can be implemented in SQL stored procedure or stored procedure equivalent in the DB of your choice.</p>

<ol>
  <li>Add these additional columns to your source table
    <ol>
      <li><strong>is_migrated</strong>: default false</li>
      <li><strong>migrated_date</strong></li>
      <li><strong>is_error</strong></li>
      <li><strong>error_description</strong></li>
    </ol>
  </li>
  <li>Create a DB migration script which
    <ol>
      <li>Copies a batch of data from one table in source DB to one table in dB.</li>
      <li>The batch size could be 1000. You don‚Äôt want the batch size to be too small because it could be slow. You don‚Äôt want it too high to be able to recover better.</li>
      <li>Whenever a batch is a complete update the is_migrated and migrated_date in the source DB. Then pick up the next batch where is_migrated is false.</li>
      <li>If there is an error, set¬†<strong>is_error</strong>¬†to_ true _and add¬†<strong>error_description</strong>.</li>
      <li>The¬†<strong>error_description</strong>¬†could be an exception that is thrown.</li>
      <li>Once the script is done, check for¬†<strong>is_error: true</strong>¬†and fix those errors in the script itself.</li>
    </ol>
  </li>
  <li>Running
    <ol>
      <li>Run the script by copying the data from PROD to your testing environment.</li>
      <li>Fix your scripts if you find¬†<strong>is_error: true</strong></li>
      <li>Once all is fixed, re-copy data from PROD to your testing environment and run again.</li>
      <li>You want to make sure everything works perfectly so that you won‚Äôt have to do much during the PROD run.</li>
      <li>Once you find all bugs are fixed, run the migration script in¬†<strong>PROD</strong>.</li>
    </ol>
  </li>
</ol>]]></content><author><name></name></author><category term="database" /><summary type="html"><![CDATA[If you are transferring from one DB to another and want to make sure it happens properly, this is the mechanism you can use.]]></summary></entry></feed>